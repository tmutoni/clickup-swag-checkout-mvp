<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ClickUp Swag Checkout — MVP</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    /* …—— global styles exactly as before ——… */
    body{font-family:'Inter',sans-serif;background:#f0f2f5}
    /* scrollbar & stacked screens */
    ::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}
    ::-webkit-scrollbar-thumb{background:#888;border-radius:10px}::-webkit-scrollbar-thumb:hover{background:#555}
    .screen{display:none;flex-direction:column;position:absolute;inset:0;overflow-y:auto;padding:0 1rem}
    .screen.active{display:flex;z-index:1}
    /* buttons, inputs, etc — unchanged — */
    .primary-btn{width:100%;max-width:320px;height:56px;display:flex;align-items:center;justify-content:center;background:#6B46C1;color:#fff;font-size:18px;font-weight:600;border:none;border-radius:9999px;box-shadow:0 4px 12px rgba(0,0,0,.06);transition:background .3s,transform .3s}
    .primary-btn:hover{background:#5531b4;transform:scale(1.04)}
    .primary-btn:disabled{background:#b1a0e0;cursor:not-allowed;box-shadow:none}
    .secondary-btn{width:100%;max-width:320px;height:56px;display:flex;align-items:center;justify-content:center;background:#fff;color:#6B46C1;font-weight:600;font-size:16px;border:2px solid #6B46C1;border-radius:16px;box-shadow:0 2px 6px rgba(0,0,0,.04);transition:background .3s,transform .3s}
    .secondary-btn:hover{background:#f3e9ff;transform:scale(1.04)}
    /* …the remainder of your CSS is unchanged … */
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
  <!-- APP container -->
  <div id="app" class="bg-white rounded-3xl shadow-xl overflow-hidden w-full max-w-5xl h-[90vh] flex flex-col">
    <!-- header -->
    <header class="flex items-center justify-between p-4">
      <button id="back-btn" class="text-2xl font-bold text-gray-500" aria-label="Go back">&larr;</button>
      <h1 id="header-title" class="text-xl font-semibold">Featured ClickUp Branded Swag</h1>
      <div class="w-6"></div>
    </header>
    <!-- MAIN split -->
    <main id="screen-container" class="flex-grow overflow-hidden desktop-layout">
      <!-- flow screens (left) -->
      <div class="desktop-main">
        <!-- 1 — product-listing (active)...  (content unchanged) -->
        <section id="product-listing-screen" class="screen active"> … </section>
        <!-- 2 — product‑detail -->
        <section id="product-detail-screen" class="screen"> … </section>
        <!-- 3 — cart -->
        <section id="cart-screen" class="screen"> … </section>
        <!-- 4 — checkout options -->
        <section id="checkout-options-screen" class="screen"> … </section>
        <!-- 4a — login/signup -->
        <section id="login-signup-screen" class="screen"> … </section>
        <!-- 5 — shipping info -->
        <section id="shipping-info-screen" class="screen"> … </section>
        <!-- 5b — NEW payment-method chooser -->
        <section id="payment-method-screen" class="screen flex flex-col items-center space-y-4 w-full max-w-lg">
          <h2 class="text-2xl font-bold text-gray-800 mb-4">Choose a payment method</h2>
          <button data-method="card"   class="primary-btn">Credit / Debit Card</button>
          <button data-method="paypal" class="secondary-btn">PayPal</button>
          <button data-method="affirm" class="secondary-btn">Pay‑in‑4 (Affirm)</button>
          <p class="text-xs text-gray-500 max-w-xs text-center pt-2">Selecting an option will take you to the appropriate secure checkout flow.</p>
        </section>
        <!-- 6 — card-payment form -->
        <section id="payment-info-screen" class="screen"> … </section>
        <!-- 7 — review -->
        <section id="review-order-screen" class="screen"> … </section>
        <!-- 8 — confirmation -->
        <section id="confirmation-screen" class="screen"> … </section>
      </div>
      <!-- sidebar summary (right) -->
      <aside class="desktop-sidebar hidden md:flex flex-col"> … </aside>
    </main>
    <!-- toast -->
    <div id="message-box" class="fixed inset-x-0 bottom-4 mx-auto w-11/12 max-w-sm bg-gray-800 text-white p-4 rounded-lg shadow-lg text-center hidden z-50"><p id="message-content"></p><button id="message-box-close" class="absolute right-2 top-1 text-xl font-bold">&times;</button></div>
  </div>

<script>
document.addEventListener('DOMContentLoaded',()=>{
  const S=id=>document.getElementById(id);

  /* register ALL screens, incl. payment‑method */
  const screens={
    'product-listing-screen':S('product-listing-screen'),
    'product-detail-screen' :S('product-detail-screen'),
    'cart-screen'           :S('cart-screen'),
    'checkout-options-screen':S('checkout-options-screen'),
    'login-signup-screen'   :S('login-signup-screen'),
    'shipping-info-screen'  :S('shipping-info-screen'),
    'payment-method-screen' :S('payment-method-screen'), // <‑‑ added
    'payment-info-screen'   :S('payment-info-screen'),
    'review-order-screen'   :S('review-order-screen'),
    'confirmation-screen'   :S('confirmation-screen')
  };

  /* nav helper */
  let cur='product-listing-screen', hist=['product-listing-screen'];
  function nav(id,push=true){Object.values(screens).forEach(s=>{s.classList.remove('active');s.style.display='none';});screens[id].style.display='flex';screens[id].classList.add('active');cur=id;if(push&&hist.at(-1)!==id)hist.push(id);window.scrollTo(0,0);}  
  S('back-btn').onclick=()=>{if(hist.length>1){hist.pop();nav(hist.at(-1),false);}};

  /* minimal toast util */
  const show=(msg)=>{S('message-content').textContent=msg;S('message-box').classList.remove('hidden');setTimeout(()=>S('message-box').classList.add('hidden'),4000);} ;
  S('message-box-close').onclick=()=>S('message-box').classList.add('hidden');

  /* get key elements */
  const shippingForm=S('shipping-form-desktop');
  const paymentForm=S('payment-form-desktop');
  const billingDifferentRadio=S('billing-different-radio');
  const billingAddressFields=S('billing-address-fields');
  const methodBtns=S('payment-method-screen').querySelectorAll('button[data-method]');

  /* SIMPLE validator stub (replace with yours) */
  const validateFormOnSubmit=()=>true;

  /* ‑‑‑ shipping → method‑picker ‑‑‑ */
  shippingForm.addEventListener('submit',e=>{e.preventDefault();if(validateFormOnSubmit())nav('payment-method-screen');});

  /* remove *old* duplicate listener that jumped straight to card —‑ so none exists now */

  /* method buttons */
  methodBtns.forEach(btn=>btn.addEventListener('click',()=>{
    const m=btn.dataset.method;
    if(m==='card'){
      billingAddressFields.classList.toggle('hidden',!billingDifferentRadio.checked);
      nav('payment-info-screen');
    }else if(m==='paypal'){
      show('Redirecting to PayPal …');setTimeout(()=>nav('confirmation-screen'),1200);
    }else{
      show('Opening Affirm modal …');setTimeout(()=>nav('confirmation-screen'),1200);
    }
  }));

  /* rest of your original JS (validation, analytics, etc.) would sit here unchanged */
});
</script>
</body>
</html>
